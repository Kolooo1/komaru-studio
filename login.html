<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Вход в систему | Komaru Studio</title>
    <meta name="description" content="Вход в систему публикации постов Komaru Studio">
    <!-- Иконка сайта -->
    <link rel="icon" href="assets/icons/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="assets/icons/favicon.ico" sizes="any">
    <link rel="apple-touch-icon" href="assets/icons/apple-touch-icon.png">
    <!-- Подключение стилей -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/post-system.css">
    <!-- Подключение шрифтов -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
    // Применить тему сразу, до загрузки страницы
    (function() {
        var savedTheme = localStorage.getItem('portfolio-theme') || 'light';
        document.documentElement.classList.add(savedTheme + '-theme');
    })();
    </script>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">
                <a href="index.html" class="logo-link">
                    <span>Komaru Studio</span>
                </a>
            </div>
            <div class="nav-controls">
                <ul class="nav-links">
                    <li><a href="index.html">Главная</a></li>
                    <li><a href="index.html#about">О нас</a></li>
                    <li><a href="index.html#projects">Проекты</a></li>
                    <li><a href="index.html#contact">Контакт</a></li>
                    <li><a href="posts.html">Публикации</a></li>
                </ul>
                <div class="theme-toggle">
                    <button id="theme-toggle-btn" aria-label="Переключить тему">
                        <svg class="light-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="dark-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                </div>
                <div class="lang-dropdown">
                    <button id="lang-toggle-btn" aria-label="Выбрать язык" class="lang-dropdown-btn">
                        <span id="current-lang" data-lang="current-lang">RU</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dropdown-arrow">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="lang-dropdown-content">
                        <button class="lang-option" data-lang-code="ru">Русский</button>
                        <button class="lang-option" data-lang-code="en">English</button>
                        <button class="lang-option" data-lang-code="zh">中文</button>
                    </div>
                </div>
                <button class="mobile-menu-btn" aria-label="Меню">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </nav>
    </header>

    <main class="main-content" style="display:block !important; visibility:visible !important; padding-top:50px; min-height:80vh;">
        <!-- Декоративные элементы фона -->
        <div class="bg-shape shape-1"></div>
        <div class="bg-shape shape-2"></div>
        
        <section class="auth-section" style="display:block !important; visibility:visible !important; position:relative; z-index:100; margin-top:60px;">
            <div class="container">
                <div class="auth-container" style="display:block !important; visibility:visible !important; opacity:1 !important; position:relative; z-index:100; background-color:var(--color-background-secondary); box-shadow:0 8px 30px rgba(0,0,0,0.15);">
                    <h1 class="auth-title" data-lang="login-title">Вход в систему</h1>
                    <form id="login-form" class="auth-form">
                        <div class="form-group">
                            <label for="username" data-lang="login-username">Имя пользователя</label>
                            <input type="text" id="username" required>
                        </div>
                        <div class="form-group">
                            <label for="password" data-lang="login-password">Пароль</label>
                            <div class="password-field">
                                <input type="password" id="password" required>
                                <button type="button" id="toggle-password" class="password-toggle" aria-label="Показать пароль">
                                    <div class="toggle-icon-wrapper">
                                        <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7-10-7-10-7z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                        <svg class="eye-off-icon" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                            <line x1="2" y1="2" x2="22" y2="22"></line>
                                        </svg>
                                    </div>
                                </button>
                            </div>
                        </div>
                        <div id="auth-message" class="auth-message"></div>
                        <button type="submit" class="btn btn-primary" data-lang="login-button">Войти</button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <span>KS</span>
                </div>
                <div class="footer-copy">
                    <p>© <span id="current-year">2024</span> Komaru Studio. Все права защищены.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Подключение скриптов -->
    <script src="js/translations.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // Устанавливаем текущий год
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Инициализация переводов
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализируем переводы если они доступны
            if (window.TranslationSystem && typeof window.TranslationSystem.initLanguage === 'function') {
                window.TranslationSystem.initLanguage();
            }
            
            // Гарантируем видимость блока входа
            const mainContent = document.querySelector('.main-content');
            const authSection = document.querySelector('.auth-section');
            const authContainer = document.querySelector('.auth-container');
            
            if (mainContent) {
                mainContent.style.display = 'block';
                mainContent.style.visibility = 'visible';
                mainContent.classList.add('visible');
            }
            
            if (authSection) {
                authSection.style.display = 'block';
                authSection.style.visibility = 'visible';
            }
            
            if (authContainer) {
                authContainer.style.display = 'block';
                authContainer.style.visibility = 'visible';
                authContainer.style.opacity = '1';
            }
            
            // Настройка формы входа
            const loginForm = document.getElementById('login-form');
            if (loginForm) {
                // Очищаем любые скрытые обработчики событий
                const oldForm = loginForm.cloneNode(true);
                loginForm.parentNode.replaceChild(oldForm, loginForm);
                
                // Добавляем обработчик формы
                oldForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;
                    const messageElement = document.getElementById('auth-message');
                    
                    // Демонстрационные учетные данные
                    if (username === 'admin' && password === '11rree') {
                        // Получаем сообщение об успешном входе из системы переводов
                        let successMessage = 'Успешный вход. Перенаправление...';
                        
                        if (window.TranslationSystem && window.TranslationSystem.translations) {
                            const currentLang = document.documentElement.lang || 'ru';
                            if (window.TranslationSystem.translations['login-success'] && 
                                window.TranslationSystem.translations['login-success'][currentLang]) {
                                successMessage = window.TranslationSystem.translations['login-success'][currentLang];
                            }
                        }
                        
                        messageElement.textContent = successMessage;
                        messageElement.className = 'auth-message success';
                        messageElement.style.display = 'block';
                        
                        // Сохранение данных
                        const authData = {
                            username: 'admin',
                            role: 'admin',
                            name: 'Администратор'
                        };
                        
                        localStorage.setItem('komaru-auth', JSON.stringify(authData));
                        
                        setTimeout(() => {
                            window.location.href = 'posts.html';
                        }, 1000);
                    } else if (username === 'author1' && password === 'author123') {
                        // Автор 1
                        const successMessage = window.TranslationSystem && 
                            window.TranslationSystem.translations && 
                            window.TranslationSystem.translations['login-success'] ? 
                            window.TranslationSystem.translations['login-success'][document.documentElement.lang || 'ru'] : 
                            'Успешный вход. Перенаправление...';
                        
                        messageElement.textContent = successMessage;
                        messageElement.className = 'auth-message success';
                        messageElement.style.display = 'block';
                        
                        localStorage.setItem('komaru-auth', JSON.stringify({
                            username: 'author1',
                            role: 'author',
                            name: 'Автор 1'
                        }));
                        
                        setTimeout(() => {
                            window.location.href = 'posts.html';
                        }, 1000);
                    } else {
                        // Получаем сообщение об ошибке из системы переводов
                        let errorMessage = 'Неверное имя пользователя или пароль';
                        
                        if (window.TranslationSystem && window.TranslationSystem.translations) {
                            const currentLang = document.documentElement.lang || 'ru';
                            if (window.TranslationSystem.translations['login-error'] && 
                                window.TranslationSystem.translations['login-error'][currentLang]) {
                                errorMessage = window.TranslationSystem.translations['login-error'][currentLang];
                            }
                        }
                        
                        messageElement.textContent = errorMessage;
                        messageElement.className = 'auth-message error';
                        messageElement.style.display = 'block';
                    }
                });
            }
            
            // Обработчик кнопки показа/скрытия пароля
            const togglePasswordBtn = document.getElementById('toggle-password');
            const passwordInput = document.getElementById('password');
            
            if (togglePasswordBtn && passwordInput) {
                togglePasswordBtn.addEventListener('click', function() {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    this.classList.toggle('show');
                    
                    // Изменение атрибута aria-label для доступности
                    const newLabel = type === 'password' ? 'Показать пароль' : 'Скрыть пароль';
                    this.setAttribute('aria-label', newLabel);
                });
            }
        });
        
        // Переключение темы
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        if (themeToggleBtn) {
            themeToggleBtn.addEventListener('click', function() {
                // Проверяем наличие класса light-theme
                if (document.documentElement.classList.contains('light-theme')) {
                    document.documentElement.classList.remove('light-theme');
                    document.documentElement.classList.add('dark-theme');
                    localStorage.setItem('portfolio-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark-theme');
                    document.documentElement.classList.add('light-theme');
                    localStorage.setItem('portfolio-theme', 'light');
                }
            });
        }
        
        // Мобильное меню
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const navLinks = document.querySelector('.nav-links');
        
        if (mobileMenuBtn && navLinks) {
            mobileMenuBtn.addEventListener('click', function() {
                navLinks.classList.toggle('nav-active');
                mobileMenuBtn.classList.toggle('menu-open');
            });
        }
    </script>
    
    <style>
    /* Переопределение стилей для обеспечения видимости блока входа */
    .main-content {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        padding-top: 20px !important;
        min-height: 80vh !important;
    }
    
    /* Стили для выпадающего меню языков */
    .lang-dropdown {
        position: relative;
        z-index: 1000 !important;
    }
    
    .lang-dropdown-content {
        position: absolute;
        top: 100%;
        right: 0;
        background-color: var(--color-background);
        min-width: 120px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        overflow: hidden;
        z-index: 2000 !important;
        display: none;
    }
    
    .lang-dropdown.active .lang-dropdown-content {
        display: block;
    }
    
    .lang-option {
        display: block;
        width: 100%;
        padding: 10px 15px;
        text-align: left;
        border: none;
        background: none;
        cursor: pointer;
        font-size: 14px;
        color: var(--color-text-primary);
        transition: background-color 0.3s;
    }
    
    .lang-option:hover {
        background-color: var(--color-background-secondary);
    }
    
    .lang-option.active {
        background-color: var(--color-background-accent);
        font-weight: 500;
    }
    
    .auth-section {
        padding: 40px 0 80px !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        z-index: 100 !important;
        margin: 60px auto !important;
    }
    
    .auth-container {
        max-width: 450px !important;
        margin: 0 auto !important;
        padding: 30px !important;
        background-color: var(--color-background-secondary) !important;
        border-radius: 12px !important;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15) !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
        z-index: 100 !important;
    }
    
    /* Исправление стилей для сообщений */
    .auth-message {
        padding: 12px !important;
        border-radius: 6px !important;
        margin: 15px 0 !important;
        font-size: 14px !important;
        text-align: center !important;
        display: none !important; /* По умолчанию скрыт */
    }
    
    .auth-message.error {
        background-color: rgba(231, 76, 60, 0.1) !important;
        color: #e74c3c !important;
        border: 1px solid rgba(231, 76, 60, 0.2) !important;
        display: block !important; /* Показываем при ошибке */
    }
    
    .auth-message.success {
        background-color: rgba(46, 204, 113, 0.1) !important;
        color: #2ecc71 !important;
        border: 1px solid rgba(46, 204, 113, 0.2) !important;
        display: block !important; /* Показываем при успехе */
    }
    
    /* Скрываем все, что может мешать отображению формы */
    .splash-screen {
        display: none !important;
    }
    
    /* Стили для поля пароля с иконкой */
    .password-field {
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
    }
    
    .password-toggle {
        position: absolute;
        right: 10px;
        top: 40%;
        transform: translateY(-50%);
        background: none;
        border: none;
        margin: 0;
        padding: 0;
        width: 36px;
        height: 36px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        z-index: 2;
    }
    
    .toggle-icon-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background-color: rgba(136, 136, 136, 0.1);
        transition: all 0.2s ease;
    }
    
    .password-toggle:hover .toggle-icon-wrapper {
        background-color: rgba(136, 136, 136, 0.2);
        transform: scale(1.05);
    }
    
    .password-toggle:active .toggle-icon-wrapper {
        transform: scale(0.95);
    }
    
    .password-toggle:focus {
        outline: none;
    }
    
    .password-toggle:focus .toggle-icon-wrapper {
        box-shadow: 0 0 0 2px rgba(136, 136, 136, 0.3);
    }
    
    .eye-icon, .eye-off-icon {
        color: #888888;
        transition: all 0.2s ease;
    }
    
    .dark-theme .eye-icon, .dark-theme .eye-off-icon {
        color: #a0a0a0;
    }
    
    .eye-off-icon {
        display: none;
    }
    
    .password-toggle.show .eye-icon {
        display: none;
    }
    
    .password-toggle.show .eye-off-icon {
        display: block;
    }
    
    /* Исправление отступа для поля пароля */
    #password {
        padding-right: 45px;
        width: 100%;
    }
    </style>
</body>
</html> 